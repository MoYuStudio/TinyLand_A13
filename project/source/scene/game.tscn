[gd_scene load_steps=7 format=3 uid="uid://kopibfgoc8i3"]

[ext_resource type="PackedScene" uid="uid://cfpcen4gocd1i" path="res://source/system/world.tscn" id="1_ibojt"]
[ext_resource type="PackedScene" uid="uid://fx1hxuoksmee" path="res://source/animation/transition_1.tscn" id="2_sqya3"]
[ext_resource type="Texture2D" uid="uid://do4ks8ackpthp" path="res://resource/graphics/ui/aim_point.png" id="5_632i4"]
[ext_resource type="FontFile" uid="uid://ckmyjvou4nb1f" path="res://resource/graphics/font/kenney_pixel.ttf" id="7_vfiph"]
[ext_resource type="PackedScene" uid="uid://blhiffqgf5ppu" path="res://source/scene/stop_menu.tscn" id="8_8ijyi"]

[sub_resource type="GDScript" id="GDScript_mah7m"]
script/source = "
extends Node3D

var stop_menu

func _ready():
	$GUI/StopMenu.visible = false
	$Transition/AnimationPlayer.play('init')
	await $Transition/AnimationPlayer.animation_finished

func _process(delta):
	#$GridMap.collision_point = $Camera.collision_point
	#$GridMap.collision_side = $Camera.collision_side
	#$GridMap.collision_type = $Camera.collision_type
	
	#$Camera.transform.pos.x = $World.camera_transform_x
	#$Camera.transform.z = $World.camera_transform_z
	
	pass

func _physics_process(delta):
	if $GUI/StopMenu/Continue.button_click == true:
		stop_menu = false
		$GUI/StopMenu.visible = false
		$Camera.mouse_lock = true
	
	# movement inputs
	if Input.is_action_pressed('Esc'):
		stop_menu = true
		$GUI/StopMenu.visible = true
		$World/Camera.mouse_lock = false
		
		#get_tree().quit()
"

[node name="Game" type="Node3D"]
script = SubResource("GDScript_mah7m")

[node name="World" parent="." instance=ExtResource("1_ibojt")]

[node name="GUI" type="CanvasLayer" parent="."]

[node name="AimPoint" type="Sprite2D" parent="GUI"]
modulate = Color(1, 1, 1, 0.784314)
texture_filter = 1
position = Vector2(320, 180)
scale = Vector2(2, 2)
texture = ExtResource("5_632i4")

[node name="Ver" type="Label" parent="GUI"]
modulate = Color(1, 1, 1, 0.490196)
texture_filter = 1
offset_left = 219.0
offset_top = 11.0
offset_right = 414.0
offset_bottom = 56.0
theme_override_fonts/font = ExtResource("7_vfiph")
theme_override_font_sizes/font_size = 16
text = "MoYuStuido 2023
TinyLand A12    Power BY Godot 4.0
a2023012701"
horizontal_alignment = 1

[node name="StopMenu" parent="GUI" instance=ExtResource("8_8ijyi")]
visible = false

[node name="Transition" parent="." instance=ExtResource("2_sqya3")]
